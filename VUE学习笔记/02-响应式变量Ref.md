# 02. å“åº”å¼åŸºç¡€ï¼šref ä¸ reactive ğŸŒ¸

åœ¨ Vue 3 ç»„åˆå¼ API (Composition API) ä¸­ï¼Œå“åº”å¼æ˜¯æ ¸å¿ƒã€‚ç†è§£ `ref` å’Œ `reactive` çš„åŒºåˆ«æ˜¯å…¥é—¨çš„ç¬¬ä¸€æ­¥ã€‚

## 1. ä¸ºä»€ä¹ˆæ™®é€šå˜é‡ä¸è¡Œï¼Ÿ

```javascript
let count = 0;
function increment() {
  count++; // JS å˜é‡ç¡®å®å˜äº†
  // ä½†æ˜¯ DOM ä¸çŸ¥é“ï¼ç•Œé¢ä¸ä¼šåˆ·æ–°ã€‚
}
```

Vue éœ€è¦ä¸€ç§æœºåˆ¶æ¥**åŠ«æŒ**æ•°æ®çš„è¯»å†™ï¼Œä»¥ä¾¿åœ¨æ•°æ®å˜åŒ–æ—¶é€šçŸ¥è§†å›¾æ›´æ–°ã€‚

## 2. ref()

`ref` ç”¨äºå®šä¹‰**åŸºæœ¬æ•°æ®ç±»å‹**ï¼ˆString, Number, Booleanï¼‰çš„å“åº”å¼çŠ¶æ€ã€‚

```javascript
import { ref } from 'vue';

const count = ref(0);

console.log(count); // RefImpl { value: 0, ... }
console.log(count.value); // 0

count.value++; // è§†å›¾ä¼šè‡ªåŠ¨æ›´æ–°
```

### åŸç†
å› ä¸º JS çš„åŸºæœ¬ç±»å‹ï¼ˆå¦‚æ•°å­— `0`ï¼‰æ˜¯**å€¼ä¼ é€’**çš„ï¼Œæ— æ³•è¢«ä»£ç†ã€‚Vue åˆ›å»ºäº†ä¸€ä¸ªåŒ…è£…å¯¹è±¡ï¼ˆWrapper Objectï¼‰ï¼Œå°†å€¼æ”¾åœ¨ `.value` å±æ€§ä¸­ï¼Œç„¶ååˆ©ç”¨ `get` å’Œ `set` æ‹¦æˆª `.value` çš„è¯»å†™ã€‚

### æ¨¡æ¿ä¸­çš„è‡ªåŠ¨è§£åŒ…
åœ¨ HTML æ¨¡æ¿ä¸­ï¼Œä½ **ä¸éœ€è¦**å†™ `.value`ã€‚
```html
<!-- âœ… æ­£ç¡® -->
<div>{{ count }}</div>

<!-- âŒ é”™è¯¯ -->
<div>{{ count.value }}</div>
```

## 3. reactive()

`reactive` ç”¨äºå®šä¹‰**å¯¹è±¡ç±»å‹**ï¼ˆObject, Array, Map, Setï¼‰çš„å“åº”å¼çŠ¶æ€ã€‚

```javascript
import { reactive } from 'vue';

const state = reactive({
  count: 0,
  user: {
    name: 'Sakura'
  }
});

// ä¸éœ€è¦ .value
state.count++;
```

### åŸç†
Vue 3 ä½¿ç”¨ ES6 çš„ `Proxy` å¯¹è±¡ç›´æ¥ä»£ç†åŸå¯¹è±¡ã€‚ç›¸æ¯” Vue 2 çš„ `Object.defineProperty`ï¼Œ`Proxy` èƒ½æ›´å¥½åœ°ç›‘å¬æ•°ç»„å˜åŒ–å’Œå±æ€§çš„æ–°å¢/åˆ é™¤ã€‚

## 4. ref vs reactiveï¼šå¦‚ä½•é€‰æ‹©ï¼Ÿ

è¿™æ˜¯ Vue ç¤¾åŒºæœ€å¤§çš„äº‰è®ºç‚¹ä¹‹ä¸€ã€‚

| ç‰¹æ€§ | ref | reactive |
| :--- | :--- | :--- |
| **æ”¯æŒç±»å‹** | æ‰€æœ‰ç±»å‹ (åŸºæœ¬+å¯¹è±¡) | ä»…å¯¹è±¡å¼•ç”¨ç±»å‹ |
| **JS ä¸­è®¿é—®** | éœ€è¦ `.value` | ç›´æ¥è®¿é—® |
| **è§£æ„èµ‹å€¼** | å®‰å…¨ | **ä¸¢å¤±å“åº”æ€§** (é™¤éç”¨ `toRefs`) |
| **æ›¿æ¢æ•´ä¸ªå¯¹è±¡** | æ”¯æŒ (`obj.value = {}`) | ä¸æ”¯æŒ (`state = {}` ä¼šæ–­å¼€è¿æ¥) |

### æœ€ä½³å®è·µå»ºè®®

> **æ¨èé»˜è®¤ä½¿ç”¨ `ref`**ã€‚

è™½ç„¶ `.value` å†™èµ·æ¥ç¨å¾®éº»çƒ¦ä¸€ç‚¹ç‚¹ï¼Œä½†å®ƒæ›´å®‰å…¨ï¼Œæ›´ä¸å®¹æ˜“å‡ºé”™ï¼Œä¸”èƒ½æ¸…æ™°åœ°è¡¨æ˜"è¿™æ˜¯ä¸€ä¸ªå“åº”å¼å˜é‡"ã€‚

å¦‚æœä½ çš„æ•°æ®æœ‰ç€éå¸¸æ˜æ˜¾çš„å±‚çº§ç»“æ„ï¼ˆæ¯”å¦‚è¡¨å•æ•°æ®ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ `reactive`ï¼š

```javascript
const formData = reactive({
  username: '',
  password: '',
  email: ''
});
```

## 5. è§£æ„æ—¶çš„é™·é˜±

**é”™è¯¯ç¤ºèŒƒï¼š**
```javascript
const state = reactive({ count: 0 });
let { count } = state; 

count++; // âŒ åªæœ‰å±€éƒ¨å˜é‡ count å˜äº†ï¼Œstate.count æ²¡å˜ï¼Œè§†å›¾ä¹Ÿä¸ä¼šæ›´æ–°ï¼
```

**æ­£ç¡®ç¤ºèŒƒï¼š** ä½¿ç”¨ `toRefs`
```javascript
import { toRefs } from 'vue';

const state = reactive({ count: 0 });
const { count } = toRefs(state);

count.value++; // âœ… ä¿æŒäº†å“åº”å¼è¿æ¥
```